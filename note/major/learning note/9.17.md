# 0 总结

## 概念

==钢包精炼炉(Ladle refining furnace LF)==是指兼具炼钢炉加热精炼功能的设备。是用来对初炼炉（电弧炉、平炉、转炉）所熔钢水进行精炼，并且能调节钢水温度，工艺缓冲，满足连铸、连轧的重要冶金设备。钢包炉是炉外精炼的主要设备之一。

==真空脱气（RH）工艺流程==：首先将钢水吸入真空室，接着在两个上升管的侧壁向钢水内吹入氩气。这些氩气在钢水的高温和真空室上部的低压作用下迅速膨胀，导致钢水与气体的混合体的密度沿着浸入管的高度方向不断降低，在由密度差产生的压力差的作用下，使钢水进入真空室。进入真空室的钢水与气体的混合体在高真空的作用之下释放出气体，与此同时，使钢水变成钢水珠，钢水珠内欲脱除的气体在高真空的作用下向真空中释放的过程中又使钢水珠变成更小的钢水珠，从而达到了十分好的脱气效果。释放了气体的钢水沿着下降管返回到钢包中。这样循环若干次后，可将钢液中的气体降到相当低的水平。

==BOF法(BOF steelmaking)是氧气顶吹转炉炼钢法==

氧气顶吹熔融还原炼铁工艺主要的特点是：加速还原过程、能耗降低、流程简短、热效率高、热利用率大，在生成过程中以还原煤作为主要的能源，将混合好的铁矿石、煤粉和熔剂直接由皮带机输送到加料仓内，富氧空气和氮气在不同的压力下由浸入到熔池的水冷喷枪喷吹到炉内，在高温状态下，进入到熔池中的碳一部分燃烧放出大量的热量，一部分溶解在高温熔池中把铁氧化物还原，生产出液态铁水．即在1450-1 650℃高温条件下，还原煤迅速地融解在铁液中，从而与预热过的铁氧化物发生反应，产生铁元素和CO的冶金过程；工艺主要的两个重要反应发生在熔融还原炉的下部的高温铁水熔池中，即碳素的快速溶解和熔融的铁氧化物的直接还原

==KR (Kambara Reactor)法脱硫==，是1963年Nippon Steel为了限制对镁的用量，广烟厂研究发明的。1965年应用于工业生产。所谓KR法脱硫，是将浇注耐火材料并经过烘烤的十字形搅拌头，浸入铁水包熔池一定深度，借其旋转产生的漩涡，经过称量的脱硫剂由给料器加入到铁水表面，并被旋涡卷入铁水中使氧化钙基脱硫粉剂与铁水充分接触反应，达到脱硫目的。

==双联炼钢法==：采用一座转炉进行铁水脱磷，另一座转炉脱碳和提温，两座转炉双联组织生产，以达到有效改善钢的质量和缩短冶炼周期的目的。工艺路线:高炉铁水→铁水罐→铁水喷镁脱硫、扒渣→铁水包→脱磷转炉→脱碳转炉→LF或RH精炼叶→连铸机。

==作业计划编制常用的时间倒推法==，是在多任务、多工位和多路径的多对多映射的生产流程网络图结构中，每项作业任务分别**沿加工工艺路径的反方向**，从最后一道工序开始，依次选择路径进行时间的倒推计算，确定出任务在各工序上的开始与结束作业时间并确定具体的加工工位，直到首道工序，这是一种任务的时间串行倒推方法。

==炼钢—连铸==（Steelmaking-Continuous Casting）过程是钢铁制造全流程中的关键环节：高温液 态铁水经过炼钢、精炼和连铸３类工序加工转换成 固态钢坯后，送往下游热轧工序轧制成材。

炼钢炉一次产出的钢水称为==炉次==（最小加工单元）。

同一连铸中间包寿命周期内连续加工的炉次集合称为==浇次==。

## 疑问

Q1:为什么这里半钢硅有一个系数（7）

![image-20220914095635523](C:\Users\jyh\AppData\Roaming\Typora\typora-user-images\image-20220914095635523.png)

Q2: 1/n 含义 （9中参数定义6式） 9 难度大

## 建模

```matlab
[c]=xlsread('C:\Users\jyh\Desktop\work\study\note\major\rawdata.xlsx', 1);
[d]=xlsread('C:\Users\jyh\Desktop\work\study\note\major\rawdata.xlsx', 2);
g=5;
t=3;
psu = 19;
q = 220;
psl = 171;
i = 15;
j = 30;
k = 3;
x = binvar(i,j);
y = binvar(i,k);
z = binvar(i,j,k);
dj_zij = reshape(reshape(z,i*k,j)*d,i,k);

t1 = sum(x(1:g),1);
t2 = sum(x(g+1,2*g),1);
t3 = sum(x(2*g+1,3*g),1);

Objective = sum(repmat(d,1,i).*(c.*x)','all') + sum(psu*q*y,'all') - psu*d'*(sum(x,1))' + psl*d'*(1-sum(x,1))';
Constraints = [sum(sum(z,3),1) <= ones(1,j),...
               dj_zij <= q*y,...
               x == sum(z,3),...
               sum(t1,2) <= 11,...
               sum(t1,2) >= 8,...
               sum(t2,2) >= 8,...
               sum(t2,2) <= 11,...
               sum(t3,2) >= 6,...
               sum(t3,2) <= 9,...
               ];
optimize(Constraints,Objective);          
```

问题分析：

模型的约束条件存在问题，惩罚矩阵存在问题，由于缺乏数据，随机产生的数据通过测试后会陷入局部最优，不是正确的答案。

对流程分析机理不够透彻，不能准确的建立目标函数的约束条件

## 收获

1. 建立模型的流程为：初始化数据+读取数据；确定损失函数；确定约束条件；确定算法；确定变量的范围；优化训练
2. 不同的算法使用范围不同，使用MATALB采用了黑箱的算法工具，不能准确把握优化模型，得到结论。
3. NP问题可以优化为整数指派问题，下阶段需要学习对应的算法，脱离MATLAB环境设计算法，建立模型。
4. 矩阵乘法能大幅简化for循环操作，优化算法速度。
5. https://www.cnblogs.com/youcans/p/14879804.html

## 下阶段学习目标

1. 学习匈牙利算法，在SciPy中体验算法，编程实现 https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.linear_sum_assignment.html#scipy.optimize.linear_sum_assignment
2. 学习遗传算法，学会使用scikit-opt库https://scikit-opt.github.io/scikit-opt/#/zh/README
3. 深入学习炼钢--连铸--热轧的工业流程，分析每个部分的物理常量，便于后续建模



# 1 动态生产环境中的炼钢——连铸生产调度问题研究

## 1.1 概述

针对炼钢—连铸生产过程，提出了“生产场景”的概念及其数学描述。

借助于“生产场景” 描述来编制炼钢—连铸生产调度计划及解决扰动下的重调度问题可提高调度方案的现场适应性。

该区段主要涉及炼钢－精炼－连铸等主要生产工序，是 典型的从离散到连续的混合式流程生产过程。

炼钢—连铸生产调度问题包含调度计划编制和扰动下的重调度两大方面。

炉次计划属于炼钢-连铸段的生产批量计划。在炼钢-连铸生产阶段，由于中间合同（热轧板坯）或最终合同（如热轧带钢）的需求在钢级、规格、物理特性、交货期等诸因素之间存在一定差别，根据炼钢工艺的要求和组成同一炉次的合同的特征限制，需要将合同进行组合，形成不同的炉次计划，使得每一个炉次内在保证最低冶炼炉容要求下，合同之间最少的交货期差异，最大的成材率和最低的生产成本以及最少的无委材。

甘特图（Gantt chart）又称为横道图、条状图(Bar chart)。其通过条状图来显示项目、进度和其他时间相关的系统进展的内在关系随着时间进展的情况。



## 1.2 生产场景描述

- 若干生产物流进行加工或运输，不断有待加工的生产物流进入流程、完成浇铸任务后的生 产物流离开流程，这样的动态生产过程可以被表示成“生产场景”的动态变化过程。

- 某一时刻下的“生产场景”信息包含当前时刻生产流程中的设备状态及其主要的加工信息、生产物流性质及其主要的加工信息、正在执行的生产作业任务信息。

### 1.2.1 参数定义

t 时刻的“生产场景” $S_t$ 可以用三元组$M|L|J$来描述

$M$:“生产场景”中的设备信息

$L$:“生产场景”中的生产物流信息

$J$:“生产场景”中的炉次任务信息

$_i$:标识

$_s$:状态信息
$_c$:状态持续时间
$_q$:品质
$_r$:加工路径

$_b$:开始时间

$_e$:结束时间

$M_i$: 设备区别于流程中其它设备的唯一标识

$M_s$: $M_i$ 在 t 时刻所处的状态，有空闲、加工和故障三种状态

$M_c$: 表示到 t 时刻为止， $M_i$ 的状态 $M_s$ 的持续时间。当 $M_i$ 从一种状态变为另一种状态时， $M_c$ 清零

$L_i$: 物流区别于流程中其他物流的唯一标识，针对炼钢—连铸过程，同一冶炼周期内注入同一转炉内进行冶炼的铁水以及该铁水经转炉冶炼后对应的钢水称为一个物流

$L_s$:  $L_i$ 在 t 时刻所处的状态，有等待加工、 加工和运输三种状态。

$L_q$: $L_i$ 在 t 时刻的品质信息，包括温度和成分信息

$L_c$: 到 t 时刻为止， $L_i$的 状态 $L_s$ 的持续时间。当 $L_i$ 从一种状态变为另一种状态时， $L_c$ 清零。

$L_r$: $L_i$ 在 t 时刻已加工设备 $M_i$ 的有序集合，当 $L_i$ 在 $M_i$ 上开始加工时， $M_i$ 就加入$L_r$

$J_i$:与$L_i$关联的炉次号

$J_i$:炉次区别于调度计划中其它炉次的唯一标识，炉次是预先假定的流程中被调度的对象，是虚拟的物流。生产过程中，当物流 $L_i$ 运送至炼钢—连铸流程时，需要与 $J_i$ 进行关联后才能确定对应的生产任务信息。

$J_q$：$J_i$ 在预定加工设备上加工完成后的品质要求，包括温度要求和成分要求

### 1.2.2 动态生产场景描述

炼钢—连铸的动态生产过程可以看作是“生产场景”的动态变化过程。J 用于指导和安排 M 和 L 的状态和特征发生有序变化。当L进入流程时候，找到对应的J使之匹配，但由于生产过程中产生的扰动，使得调度计划发生变化，此时需要让J对M和L更新状态。由于$J_q$作为检查物流在设备上加工后的品质是否达标的判据，一般不会变化。钢种和加工品质信息一般是不变的，时间和路径信息是可通过重调度进行修改。

![image-20220913221421987](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209132214603.png)

## 1.3 生产调度问题分析

### 1.3.1 简化处理方法对计划可执行性的影响

依据批量计划的调度计划编制也应该是按批次进行，因此要处理调度计划的各批次之间的有效衔接问题。

对于单一批次炼钢—连铸调度计划：

① 假设各设备的初始状态为空，即在调度计划编制的初始时刻所有设备均可用。 

新的调度计划的编制需要通过读取正在执行的 J 中的调度计划信息及计划的执行实绩信息，得到各设备的最早可用时间，并以此为约束才能编制出时间不冲突的、 可执行的调度计划。

② 假设各铸机加工第一炉的开始时间为上层批量计划中规定的时间。

若铸机需要连浇，则该铸机加工第一炉的开始时间等于它的最早可用时间（若该炉次与前一 炉属于不同的浇次，则需要加上一个更换中间包的时间），没有优化余地；若铸机不需要连浇，则该铸机加工第一炉的开始时间可以在不早于它的最早可用时间和批量计划中预定的开浇时间的前提下进行优化。

### 1.3.2 生产物流与调度计划的匹配决策

生产物流是流程中进行加工的对象，但炉次是预先假定的流程中被调度的对象，是虚拟的物流。

导致生产过程中需要进行物流和炉次间的匹配决策的原因主要有以下几点：

①由于高炉间歇出铁的特征，同一时段运送至炼钢—连铸流程的铁水量将会大于一个炉次的要求；

②针对存在多个转炉的生产流程，当铁水运送至炼钢—连铸流程时，在合理的时间范围内，可能有多个转炉需要开始加工一个新的炉次；

③铁水的成分存在差异，炉次对应的钢种也存在差异。

### 1.3.3 重调度处理

在每一个场景更新后，需要判断是否出现偏差，若出现偏差，则需要采用相应的策略进行重调度。

重调度时，首先需要对正在执行的调度计划所对应的炉次任务集合 J 进行分类。已经完成浇铸的炉次为已完成作业炉次集$J_P$，正在炼钢—连铸流程内加工的炉次为正在作业炉次集合$J_H$ ，还没有进入炼钢 —连铸流程内加工的炉次为未作业炉次集合$J_W$。

若加工 $J_i$，其离开流程时的最终成分不 能满足其对应的炉次$J_i$所对应的钢种品质要求$J_q$，则$J_i$ 属于 $J_W$ ，在后续加工中需要与新的物流重新匹配。

## 1.4 案例分析

### 1.4.1 动态生产环境中的调度计划编制案例

![image-20220913221359896](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209132214179.png)

图2中小方块之间的距离表示运输时间，小方块的大小表示作业时间。白色部分表示调度计划编制部分，灰色表示已经完成部分。其中由于1#LF$J_{7}$完成的时候，1#转炉中的$J_1$部分没有完成，导致产生冲突，需要推迟进入1#LF流程的时间。

### 1.4.2 生产物流与调度计划的匹配案例

![image-20220913221336173](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209132213206.png)

此时需要将J与L进行匹配，由于1#转炉是炼制高品质的钢，将成分最合适的L2配置给J1。由于等待时间过长，在t2时刻，将L1配置给J4，同时将L4配置给J2。因为此时L1已经达到，这时候的等待时间修改为t2-t1+1

### 1.4.3 重调度案例

![image-20220913221300849](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209132213883.png)

此案例在J4后产生小扰动，导致J4时间后移，对后续流程产生了影响，需要进行重调度安排。将原来安排在1#LF的J10修改到了2#LF，同时调整LF，使其消耗时间最短。



# 2 钢厂生产运行模式的仿真研究

## 2.1 概述

论文建立了以炼钢生产流程网络的制造单元作为节点、以生产调度规则作为模型 演化规则的元胞自动机仿真模型。

钢厂生产过程的仿真：由于连续与离散相混杂的制造流程具有多约束、多目标、不确定性等特征，基于解析的方法难以研究此类复杂系统；而仿真方法能够考虑现实存在的动态随机因素，并能实现对生产瓶颈、生产组织策略等的分析。

元胞自动机（Cellular Automata，CA）：是一种时间、空间、状态都离散，空间相互作用和时间因果关系为局部的网格动力学模型，具有模拟复杂系统时空演化过程的能力。

## 2.2 仿真模型

基于元胞自动机思想建立的炼钢生产流程仿真模型 Cascc由元胞空间 H、元胞状态 S、元胞邻域 N、演化规则 F、信息 I、目标 O 和规则决策元 P 构成
$$
CA_{SCC} = (H,S,N,F,I,O,P)   \tag{1}
$$

$$
S^{\tau+1}_{c_i} = f^{\tau+1}_{c_i}(S^{\tau}_{c_i},S^{\tau+1}_{N}) \tag{2}
$$

$$
f^{\tau+1}_{c_i} = P(F,O^\tau,I^\tau) \tag{3}
$$

![image-20220913220848715](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209132211622.png)







# 3 钢铁生产流程物质转化与能量转换评价指标

## 3.1 概述

在国内占主流的炼铁－炼钢－连铸－热轧等长 流程钢铁制造体系中，铁素物质流（如铁矿石、废钢 和钢水等）在碳素能量流（如焦炭、煤炭和煤气等）的驱动下，按照工艺要求沿主生产工序进行化学冶金与物理冶金，通过在工序／装置的制造单元上经历一系列化学－物理变化过程、沿制造流程逐步形成钢铁产品。

钢铁制造流程的时空多尺度特点导致其物质转化与能量转换、协同规律的复杂性，如何提高全流程的物质转化与能量转换效率、减少能量在转换过程中的耗散，这是钢铁企业实现节能减排、绿色智能制造目标亟待解决的现实难题。

钢铁制造流程涉及复杂的物质转化与能量转换过程，目前采用的主要评价指标中与物质流相关的是==钢比系数==、==资源利用效率==等，与能量流相关的是==工序能耗==、==吨钢能耗和可比能耗==、==能源利用效率==和==能源转换效率==等

本文以炼铁－炼钢－连铸－热轧长流程钢铁生产的铁素物质流为对象，从钢铁制造流程及制造单元的多尺度运行等特征出发，基于物料平衡、能量守恒以及热力学原理，分析流程和单元工序／装置的物质转化与能量转换规律，设计了考虑铁素物质流在制造流程运行与制造单元冶金过程中的物质转化与能量转换的评价指标；以某炼钢厂全流程生产的 实绩数据为应用案例，给出钢铁生产以炉次为对象 的不同生产周期、运行路径下的制造流程（含主要单 元）的物质转化与能量转换情况的评价结果，并分析 了影响因素，为制造流程的物质能量协同优化提供 指导。

## 3.2 钢铁制造单元与制造流程物质转化与能量转换分析

流程系统和环境之间进行着多种形式的物质、能量、 信息的交换，整个流程形成动态——有序运行的耗散结构。

铁素物质流在能量流的驱动下沿流程方向在制造单元上发生化学变化与物理变化，物质流性质、 形态、性能发生改变，同时伴随能源需求和二次能源产出，能源供应满足制造单元的需要，二次能源产出也与物质流的转换过程相关联。



在流程层次，关注整个制造流程的物质流与能量流的协同作用及整体运行效率和效果；

在单元层次，既取决于制造单元的物质流在能量流作用下的本征反应规律（化学冶金）或 加工（物理冶金）工艺要求，也与物质流对象的物理化学性质、冶金工艺目标、设备及操作条件等的影响和调控相关。

制造单元分为了化学性质变化为主的冶金反应器（如转炉冶炼）与物理性能改变为主的其他制造单元（如连铸过程）



![image-20220913230044323](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209132300916.png)

### 3.2.1 参数定义

ｉ：为工序编号

ｊ：为物质流编号

$f_m(i,j)_{in}$ ：物质流ｊ在工序ｉ的输入铁素物质流

$f_m(i,j)_{a}$：物质流ｊ在工序ｉ加入原料或辅料等外加物料

$f_m(i,j)_{r}$：物质流ｊ在工序ｉ产生的可循环利用物质

$f_m(i,j)_{w}$：物质流ｊ在工序ｉ产生的物质损失

$f_m(i,j)_{out}$：物质流ｊ在工序ｉ加工完成后的输出铁素物质流

$f_q(i,j)_{in}$：物质流ｊ在工序 ｉ的携带能量

$f_q(i,j)_{a}$：物质流ｊ在工序ｉ的外加能源

$f_q(i,j)_{r}$：物质流ｊ在工序ｉ产生的可利用能量或能源

$f_q(i,j)_{w}$：物质流ｊ在工序ｉ的能量耗散

$f_q(i,j)_{out}$：物质流ｊ在工序ｉ带出的能量

### 3.2.2 分析

![image-20220913230750565](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209132307072.png)

从图2分析，在冶金反应器单元中，铁素物质流进入工序／装置的制造单元发生化学冶金过程（化学反应为主），带入了能量流（如铁水的物理热和化学热），过程中需要消耗外加物料和外加能源，还能产生可循环利用的物质（如冶金渣等）和能量（包括转炉煤气等二次能源），并发生物质的损耗（高炉转炉粉尘）和能量的耗散（如冶金渣携带的能量、转炉烟气等）。

其他制造单元的铁素物质流进入冶金过程，以物理变化为主，表现为铁素物质流在外加能源的条件下发生物理冶金过程，改变铁素物质流的物理性质（如连铸的钢水变铸坯，热轧的形状组织与性能改变），产生可循环利用的物质（如加热炉氧化铁皮）和能量（烟气余热回收的蒸汽），同时产生损耗（如炉体散热等）。

## 3.3 评价指标

流程物质转化率（αｊ ）定义为制造流程中作为制造对象一定时空范围内的铁素物质流经过制造流程最终输出的铁素物质流与输入的比值。
$$
\alpha_j = \frac{f_m(I,j)_{out}}{f_m(1,j)_{in} + \sum_{i=1}^If_m(i,j)_{a}} \tag{1}
$$
流程能量耗散率（φｊ ）定义为制造流程中作为制造对象的铁素物质流经过制造全流程所耗散的能量与输入能量流的比值。
$$
\phi_j = \frac{\sum_{i=1}^I\{[f_q(i,j)_{in}+f_q(i,j)_{a}]-[f_q(i,j)_{out}+f_q(i,j)_{r}]\}+\sum_{i=1}^{I-1}[f_q(i,j)_{out}-f_q(i+1,j)_{in}]}{f_q(1,j)_{in} + \sum_{i=1}^If_q(i,j)_{a}} \tag{2}
$$


过程物质转化率（αｉ，ｊ ）定义为制造单元输出的铁素物质流与输入铁素物质流的比值。
$$
\alpha_{i,j} = \frac{f_m(i,j)_{out}}{f_m(i,j)_{in} + \sum_{i=1}^If_m(i,j)_{a}} \tag{3}
$$
过程能量耗散率（φｉ，ｊ ）定义为在制造单元生产 过程中的能量耗散与输入能量流的比值
$$
\phi_{i,j} = \frac{f_q(i,j)_{w}}{f_q(i,j)_{a} + f_q(i,j)_{in}} = \frac{[f_q(i,j)_{in}+f_q(i,j)_{a}]-[f_q(i,j)_{r}+f_q(i,j)_{out}]}{f_q(i,j)_{in}+f_q(i,j)_{a}} \tag{4}
$$

## 3.4 案例分析

该炼钢厂的工艺流程包括铁水预处理、转炉炼钢（常规转炉或脱磷脱碳双联转炉）、精炼（转炉炉后吹氩喂丝、ＬＦ精炼炉、ＣＡＳ精炼、ＲＨ真空脱气等)、连铸等工序。

![image-20220913234451380](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209132344104.png)

双联脱磷、脱碳转炉物质转化率相对较高，但能量耗散率明显高于常规转炉。

主要原因是双联转炉可以少渣冶炼，但其中脱磷转炉的煤气未能回收。调控方式可通过优化转炉造渣制度和供氧制度，减少物质损失和能量耗散,提高转炉煤气回收量。

制造单元间衔接关系的紧密程度对流程能量耗散率有明显影响。铁素物质流在流程中的等待时间越长，能量耗散率越大。

# 4混合流程作业计划编制的时间并行倒推算法

## 4.1 概述

==作业计划编制==是指在满足企业现有生产条件下，在产品生产期内合理安排各生产单位或加工单元的生产活动以及产品的加工路径，最终确定在何时、何种设备、以何种顺序安排任务在各工序上加工。

分析抽象混合流程生产作业计划基本特征的基础上，建立了一种基于简化的仅表达工序和工位间逻辑关系的网络图的混合流程作业计划时间并行倒推算法，从而高效地编制可执行的生产作业计划。



==混合流程生产==中主要包括工位、运输线，以及在工位和运输路线上的作业任务。

节点表示一个或若干个作业的开始或结束点，节点不消耗资源也不占用时间；

有向线表示作业活动，消耗一定资源或占用一定的时间；有向线的方向表示加工前进方向。

==简化图网络==：将现实生产流程中的工序抽象成多个功能相同或相近的可替换的工位组合，工位上一般有主要加工设备及辅助设备等资源，作业任务在工位上完成相应的加工作业，在工位问则为运输作业。节点表示混合流程生产中的加工工位，节点间的有向线仅表示任务在工位间的运输作业，有向线的方向表示任意的运输方向。

![image-20220914000914592](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209140009279.png)

==时间倒推作业计划编制方法==是一种基于生产准时制的“拉式”计划编制方法，体现了以市场取向的 “以销定产”为依据的精益生产思想，能减少在制品数量，消除引起成本增加的种种浪费。

作业计划编制常用的时间倒推法，是在多任务、多工位和多路径的多对多映射的生产流程网络图结构中，每项作业任务分别**沿加工工艺路径的反方向**，从最后一道工序开始，依次选择路径进行时间的倒推计算，确定出任务在各工序上的开始与结束作业时间并确定具体的加工工位，直到首道工序，这是一种任务的时间串行倒推方法。

但是在生产中，通常一个工位在同一时刻只能执行一项任务。在多对多的网络图中，对多项任务进行串行倒推时，位于交叉点的工位上很容易产生作业**时间的冲突**，导致计划任务的工位资源占用安排的不合理，甚至违背正常生产时的沿流程生产线按**“先到先加工”**的一般性工位选择原则。

因此，基于生产流程网络图的对象模型，建立一种时间并行倒推算法来编制混合流程的生产作业计划是必要的。

## 4.2 参数定义

$i$：任务的序号，共有$N$个任务

$j$： 为网络图中工序的编号，共$M$道工序

$k$：工序 $j$ 上工位的编号，共$Q(j)$个工位

$i'$：工序 $j$ 工位 $k$ 上紧邻任务 $i$ 的后一任务

$j'$：任务 $i$ 加工工艺路径上工序 $j$ 的紧前工序

$\Omega$：全部任务集合

$\Theta$：最长工序编号集合  $\Theta =\{j|j\in[1,M]\}$

$\Theta_i$：任务 $i$ 的加工工艺路径，由加工经过的工序编号组成 $\Theta_i \subset \Theta$

$\Pi_i$：工序 $j$ 上的加工工位集合，由$Q(j)$个工位的编号组成 $\Pi_j=\{k|k\in[1,Q(j)]\}$

$x_{i,j}$：任务 $i$ 在工序 $j$ 上的开始作业时间

$x_{i,j,k}$：任务 $i$ 在工序 $j$ 工位 $k$ 上的开始作业时间

$t_{i,j}$：任务 $i$ 在工序  $j$ 上的作业时间

$t_{i,j,k}$：任务 $i$ 在工序 $j$ 工位 $k$ 上的作业时间

$d(j,j')$：任务在工序 $j$ 与 $j'$ 之间的运输时间

$\mu_{i,j}$： 任务 $i$ 在工序 $j$ 作业前的允许等待时间

$\mu_{max}$：任务作业前的最长允许等待时间

$\sigma_{i,j,k}$：任务 $i$ 在工序 $j$ 工位 $k$ 上与紧邻的后一任务作业间的间隙时间

$\lambda_{i,j,k}$：任务 $i$ 在工序 $j$ 工位 $k$ 上的优先加工权值

$\rho_{j,k}(x_{i,j})$：$x_{i,j}$时刻工序 $j$ 工位 $k$ 的最早可用时间，等于工位上前一任务的完工时间

$q_{j,k}(x_{i,j})$：$x_{i,j}$时刻工序 $j$ 工位 $k$ 上累计已经分配的任务总数

$\Psi_{i,j}$：任务 $i$ 在工序 $j$ 上的可用工位集合

$\Phi_{i,j-1}$：$\Psi_{i,j-1}$ 中优先加工任务 $i$ 权值最大的可用工位集合

$R_{i,j-1}$ :$\Phi_{i,j-1}$ 中加工任务 $i$ 等待时间最小的可用工位集合

$P_{i,j-1}$：$R_{i,j-1}$ 中分配任务数最小的工位集合

$C_{i,j,k}$：任务 $i$ 是否被分配给工序 $j$ 的工位 $k$ ，任务 $i$ 分配给工序 $j$ 的工位 $k$ 加工时该值为1，否则为0



所有任务在最后一道工序各工位上的开始作业时间：
$$
x'_{i,M,k}=x_{i,M,k}+t_{i,M,k}+\sigma_{i,M,k}  \\   (i,i'\in \Omega,k \in \Pi_M )\tag{1}
$$
作业任务在加工工艺路径相邻工序间的时间倒推关系及满足的约束为：
$$
x_{i,j'}=x_{i,j}-\mu_{i,j}-d(j,j')-t_{i,j'}\\i\in\Omega;j,j'\in \Theta_i \tag{2}
$$

$$
\mu_{i,j} \leq\mu_{max},i\in\Omega,j\in\Theta_i\tag{3}
$$

式(2)表示由当前作业工序的开始作业时间倒推计算任务在紧前工序的开始作业时间，式(3)表示任务在工序作业前的等待时间在最大允许等待时间范围内。

在每道工序上进行作业任务与加工工位的选择匹配时，应保证任一项任务最多被分配到相应工序中的一个工位上加工，即需满足:
$$
\sum_{k=1}^{Q(j-1)}C_{i,j-1,k}\leq1,i\in\Omega,j\in\Theta_i\tag{4}
$$
在预定工位上的作业任务的开始加工时间，能保证满足其相邻的前一任务可以完成加工之后方可，表示为：
$$
x'_{i',j,k}\leq x_{i,j,k}+t_{i,j,k}\\(i,i'\in\Omega,j\in\Theta_i,k\in\Pi_j)\tag{5}
$$

## 4.3 算法介绍

![image-20220914083529224](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209140835627.png)

设置最大工序为M，计算前序任务的开始作业时间，根据式（2）得到紧前工序的开始作业时间并确定可用的工位集合，然后对这些工位集合进行合理分配，当此时工序不是第一道时候，循环计算紧前工序的开始作业时间，此后判断得到逆推的全部工序时间后，判断是否产生冲突，如果冲突后，返回调整工序顺序，最终得到合理的工序。



安排工序顺序：工序 (j-1) 上所有任务按开始作业时间从小到大排序，再采用工位选择规则依次确定出各任务的适宜加工工位。依次启用优先加工权值最大规则Rule(1)、 最少等待时间规则Rule(2)、均衡工位的设备利用率规则Rule(3)和随机工位确定规则Rule(4)来选择适宜加工工位s。

解决冲突：整紧后任务 $i'$ 的开始和结束作业时间来消除冲突，否则调整当前任务 $i$ 和紧后任务 $i'$ 的开始和结束作业时间来消除冲突，否则统计冲突时间并重新设置流程系统的末尾工序上工位的开始加工时间。



# 5 基于UML的炼钢物流仿真系统分析与设计

## 5.1 概念

UML(Unified Modeling Language．统一建模语言)是一种直观化、明确化、构建和文档化软件系统产物的通用可视化语言。

本文将以UML作为建模语言， 以Power Designer作为CASE工具，对炼钢物流仿真系统的开发进行分析和设计，从系统分析和设计的角度对炼钢物流 仿真系统的开发进行研究。

==类图==是一切面向对象方法的核心建模工具。该图描述了系统中对象的类型以及它们之间存在的各种静态关系。

1. 关联 - 代表类型之间的关系（一个人为公司工作，一间公司有多个办事处）。
2. 继承 - 专为将实例关系图 (ERD) 应用于面向对象设计而设的一种关系。它在面向对象设计中的继承概念互相呼应。
3. 聚合 - 面向对象设计中的一种对象组合 的形式。

==序列图==根据时间序列展示对象如何进行协作。它展示了在用例的特定场景中，对象如何与其他对象交互。



# 6 基于订单驱动的钢铁企业一体化计划方法及系统

## 6.1 概念

一体化计划可拆分为订单计划（由合同池管理来实现）；一体化生产计划（ERP 层面，含热轧计划、组浇计划与组炉计划、铁水供应计划等）；生产作业计划（炼钢连铸计划，热轧作业计划等）。

![image-20220914085818778](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209140858731.png)

铁水预处理的缓冲是因间歇式出铁而一次到达多炉铁水， 从而导致铁水滞留在预处理前区；精炼工序的缓冲时间可以确保对连铸机连浇供应钢水。

连铸与热轧的工艺约束和产能的不匹配，导致 n 个浇次对应 m 个轧制单元，其中 n>m，板坯库、保温坑及加热炉的缓冲工位使得连铸与热轧得以有效的衔接。

==生产计划中物流“反向”流动的 Pull 控制==：由轧制计划推导炉次计划，再由炉次计划和轧制计划共同作用于浇次计划，最后由炉次计划指导出铁粗计划。炼铁－炼钢界面、连铸－热轧界面中，连铸对炼铁产生的 Pull 力保证它最大化连浇，同时对热轧以最大化热装热送比为目的对连铸产生 Pull 力。

## 6.2 模型描述

$$
F=min(f_1,f_2,f_3,f_4) \tag{1}
$$

$$
f_1=min\sum_{i\in N}\alpha·max\{0,a_i-(x_i+T_i)+\beta·max\{0,(x_i+T_i)-b_i\}\} \tag{2}
$$

$$
f_2(x)=\sum_{i\in N} \sum_{j \in N,j\neq i} C^1_{ij}z_{ijl} \tag{3}
$$

$$
f_3(x)==\sum_{i\in N} \sum_{j \in N,j\neq i} C^2_{ij}x_{ijh} \tag{4}
$$

$$
f_4(x)=\sum_{i\in H} \sum_{j \in H,j\neq i} C^3_{ij}y_{ijk} \tag{5}
$$

N 为生产合同数

H 为炉次集

α 、β 为合同提前和超期完工的惩罚因子

$a_i,b_i$为合同 i 的交货期

$x_i$为合同 i 的投产日期

$T_i$为合同 i 的生产总时间

$x_{ijh}$合同 i、j 编制在炉次 h 的状态

$y_{ijk}$炉次 i、j 编制到浇次 k 的状态

$z_{ijl}$为轧制单元l 中合同 j 紧邻合同 i 的状态

$C^1_{ij}，C^2_{ij}，C^3_{ij}$为轧制单元中合同 j 紧邻合同 i、合同 i,j 组炉、炉次 i,j 组浇的综合惩罚系数

函数⑴为多目标优化主函数使其四个目标函数最小化，函数⑵为基于准时制思想对各生产合同的惩罚最 小化，函数⑶、⑷、⑸为制定轧制单元、组炉、组浇工艺约束惩罚最小化。 



（1）以生产合同为输入对象，对生产合同按时间顺序，并赋予优先权，按交货期及轧机产能制订预定周 期的热轧带钢生产合同计划； 

（2）以热轧计划为输入对象，按轧制单元编制约束进行最小化惩罚，同时考虑一定的组炉约束编制轧制 单元； 

（3）以轧制单元计划为输入对象，按其约束进行最小化惩罚组炉，并把组好的炉次按时间紧要程度排序， 再对编制好的炉次按其约束条件运用智能算法按最大化产量组浇；  

（4）根据组浇计划，运用 Pull 原理方法进行仿真可得到粗略的铁水供应节奏，以确定浇次计划的可 行性； 

（5）通过对各模块的系统评价来确定一体生产计划，确保一体化计划具有全局优化性。



# 7 基于模式分类的转炉终点磷硫测模型

## 7.1 概念

采用对入炉磷硫含量及造渣操作模式进行炉次分类的方法，来减小同类炉次间入炉条件及操作的差异，进而建立基于模式分类的磷硫神经网络预测模型。 

把入炉磷硫含量及造渣操作划分出不同的模式，然后对不同模式组合分别建立相应参数的预测模型，有利于提高模型预报的效果。



## 7.2 模式分析

以渣量及碱度为依据把造渣操作划分为大渣量高碱度 、小渣量低碱度及一般渣量和碱度三种模式；把入炉磷、硫含量按其大小分为低 、 中 、 高三种模式。


$$
W(\text { slag })=\frac{W(h m) \times[\% S i] \times 60 / 28+\sum_{i=1}^{n} W_{i} \times\left((\% \mathrm{CaO})_{i}+\left(\% \mathrm{SiO}_{2}\right)_{i}+(\% \mathrm{MgO})_{i}+\left(\% \mathrm{Al}_{2} \mathrm{O}_{3}\right)_{i}\right)}{100-(\% \mathrm{TFe})} \tag{1}
$$

$$
B=\frac{\sum_{i=1}^{n} W_{i} \times\left((\% \mathrm{CaO})_{i}\right.}{W(\mathrm{hm}) \times[\% \mathrm{Si}] \times 60 / 28+\sum_{i=1}^{n} W_{i} \times\left(\% \mathrm{SiO}_{2}\right)_{i}} \tag{2}
$$

式中$W(slag)$ 为渣量；$W_i$为第 i 种辅料的装入量；$(\%CaO)i,(\%MgO)i,(\%SiO_2)i,(\%Al_2O_3)i$分别为第 i 种原料中 $CaO,Sio_2,Al_2O_3$ 的含量；$[\%Si]$为半钢硅含量；$W(hm)$为半钢装入量；$(\%TFe)$为渣中全铁含量。

==造渣料模式划分:==
$$
\left\{\begin{array}{lr}
B>B_{U} \text { 且W }(\text { slag })>W(s l a g)_{U} & \text { 大渣量、高碱度 } \\
B<B_{D} \text { 且W }(\text { slag })<W(s l a g)_{D} & \text { 小渣量、低碱度 } \\
\text { 其余 } & \text { 一般造渣 }
\end{array}\right. \tag{3}
$$
式中B为二元碱度;BU为高碱度下限;BD为低碱度上限;W(slag)U为大渣量下限；W(slag)D为小渣量上限。

==入炉磷含量模式划分：==
$$
\left\{\begin{array}{ll}
{[\% P]>[\% P]_{U}} & \text { 高磷 } \\
{[\% P]<[\% P]_{D}} & \text { 低磷 } \\
{[\% P]_{D}<[\% P]<[\% P]_{U}} & \text { 中磷 }
\end{array}\right. \tag{4}
$$
式中 [%P]为半钢磷含量；[%P]U为高磷含量下限；[%P]D为低磷含量上限。

==入炉硫含量模式划分：==
$$
\left\{\begin{array}{ll}
{[\% S]>[\% S]_{U}} & \text { 高硫 } \\
{[\% S]<[\% S]_{D}} & \text { 低硫 } \\
{[\% S]_{D}<[\% S]<[\% S]_{U}} & \text { 中硫 }
\end{array}\right. \tag{5}
$$
式中 [%S]为半钢磷含量；[%S]U为高磷含量下限；[%S]D为低磷含量上限。

## 7.3 预测模型设计

$$
y=f\left(x_{1}, x_{2}, \ldots, x_{n}\right) \tag{6}
$$

通过对因素X分析与组合 ， 得到主要影响因素集合X' ：
$$
x_{i}^{\prime}=\left\{\begin{array}{c}
x_{j} \\
\phi\left(x_{j}, x_{k}, \ldots\right)
\end{array} \quad 1 \leq i \leq m, \quad 1 \leq j \leq n, 1 \leq k \leq n\right. \tag{7}
$$
m为主要影响因素个数 ，$\phi$为因素组合函数 ，可能存在多个。

主要影响因素的样本向量，如下式：
$$
S=\left(S_{x_{1}^{\prime}}, S_{x_2^{\prime},}, \ldots, S_{x_m^{\prime}}\right) \tag{8}
$$
通过频数分析得到下图：

![image-20220914102336421](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209141023453.png)
$$
 P(X \leq D)=p 1 \tag{9} \\
$$

$$
P(X \geq U)=p 2  \tag{10}
$$

此时将影响因素样本分为三类：
$$
S_{x'_j}=(S^1_{x'_j},S^2_{x'_j},S^3_{x'_j})\tag{11}
$$
对多个影响因素样本分类结果进行组合 ， 形成多种生产模式:
$$
M=\{M_1,M_1,\dots,M_l\} \tag{12}
$$

$$
M_j = \{S^{k_1}_{x_1},S^{k_2}_{x_2},\dots,S^{k_m}_{x_m}\},k_{1,\dots,m}\in\{1,2,3\} \tag{13}
$$

M为生产模式集合 ，$l$为总生产模式数，分别建立在不同生产模式下终点磷的神经网络预测模型 。
$$
Net(M)=\{Net_1(M_1),Net_2(M_2),\dots,Net_l(M_l)\} \tag{14}
$$
Net为神经 网络模型 ，其结构如下:
$$
Net=\{InNod,OutNod,HideNod,TransFun,ErrFun,W,B\} \tag{15}
$$
TransFun,ErrFun为传递函数和误差函数。

## 7.4 结果分析

论文中发现误差较大，首先数据量不足，无法通过神经网络训练得到最佳权重。可能该数据量训练的权重陷入局部最优，没有采取batch size方法规避。可能产生过拟合现象，由于数据量不足，导致预测精度大幅下降。没有划分测试集和验证集，得到的数据置信度大幅下降。

该问题是个动态过程，不能通过简单的黑箱输入输出来进行抽象。应该采用其他的建模方法。



# 8 基于遗传算法的炼钢一连铸作业计划优化系统

不知道为什么这篇文章只有摘要。

# 9 考虑不确定加工时间的炼钢—连过程柔性调度方法

## 9.1 概念

==炼钢—连铸==（Steelmaking-Continuous Casting）过程是钢铁制造全流程中的关键环节：高温液态铁水经过炼钢、精炼和连铸３类工序加工转换成 固态钢坯后，送往下游热轧工序轧制成材。

炼钢炉一次产出的钢水称为==炉次==（最小 加工单元）。

同一连铸中间包寿命周期内连续加工的炉次集合称为==浇次==。

==中间包==是短流程炼钢中用到的一个耐火材料容器，首先接受从钢包浇下来的钢水，然后再由中间包水口分配到各个结晶器中去。

==计划指令==：浇次数量／顺序、浇次内炉次数量／顺序以及相关钢种和铸坯规格等信息

==炼钢—连铸调度的主要任务==：确定待排产炉次在各工序的加工机器（机器指派）、加工顺序（任务排序），以及操作开始时间和完工时间（时间表规划），实现一类或多类生产性能指标的最优化。

## 9.2 参数定义

| 参数         | 说明                                                         |
| ------------ | ------------------------------------------------------------ |
| G            | 工序集合，其中$G=\{1,\dots,i,\dots,g\}$,g 为工序总数         |
| $M_i$        | 工序 i 的机器集合，其中$M_i=\{1,\dots,k,\dots,m_i\},m_i$为机器数量 |
| J            | 炉次集合，其中$J=\{1,\dots,j,\dots,n\},n$为炉次总数          |
| B            | 浇次集合，其中$B=\{1,\dots,j,\dots,h\},h$为浇次总数          |
| $B_b$        | 浇次b包含的炉次集合，其中$B_b=\{B_b,\dots,B_{b,r},\dots,B_{b,h(b)}\}$,其中h(b)为$B_b$的大小 |
| $u_b$        | 浇次b开始加工的准备时间                                      |
| $O_{i,j}$    | 炉次j在工序i的操作过程                                       |
| $tr_{i,i+1}$ | 相邻工序i和i+1之间的运输时间                                 |
| $at_j$       | 轮次j的到达时间                                              |
| $p_{i,j,k}$  | 操作$O_{i,j}$在机器$M_{i,k}$上的加工时间，随机变量，其中$\bar p_{i,j,k}$为标准加工时间 |

决策变量：
$$
(1) 操作  O_{i, j}  的 开工时间  s_{i, j} \in\{0,1, \cdots, T\}, T  为最大时长。\hfill \\
(2) 操作  O_{i, j}  的加工机器  x_{i, j} \in M_{i}。\hfill
$$
资源和工艺约束:

1.加工先后性：同一台机器上两个不同操作的先后加工顺序是唯一的
$$
\begin{array}{c}
\left(x_{i, j_{1}}=x_{i, j_{2}}=k\right) \wedge\left(\left(s_{i, j_{1}}+p_{i, j_{1}, k} \leqslant s_{i, j_{2}}\right) \vee\right. 
\left.\left(s_{i, j_{1}}+p_{i, j_{1}, k} \geqslant s_{i, j_{2}}\right)\right) ;\\ 
i \in\{1, \cdots, g-1\}, k \in M_{i}, j_{1}, j_{2} \in J, j_{1} \neq j_{2} \tag{1}
\end{array}
$$
2.工艺路径约束：各炉次必须按照工艺路径的先后顺序加工，即炉次ｊ在当前工序ｉ 加工完成后，经天车运送至下道工序后方可开工。
$$
\begin{array}{c}
\left(s_{i, j}+p_{i, j, k}+t r_{i, i+1} \leqslant s_{i+1, j}\right) \wedge\left(x_{i, j}=k\right), \\
i \in\{1, \cdots, g-1\}, k \in M_{i}, j \in J 。 \tag{2}
\end{array}
$$
3.连续性约束：在连铸工序，同一浇次内的相邻炉次安排在同一机器加工，且操作之间不允许中断。
$$
\left(s_{g, B_{b, r-1}}+p_{g, B_{b, r-1}, k}=s_{g, B_{b, r}}\right)  \wedge
\left(x_{g, B_{b, r-1}}=x_{g, B_{b, r}}=k\right), 
\\ k \in M_{i}, b \in B \text {, }r \in\{2, \cdots, h(b)\} \text { 。 }  \tag{3}
$$
4.准备时间约束：在浇次ｂ开始加工之前，需考虑连铸机更换中间包的准备时间。
$$
\begin{array}{c}
\left(s_{g, B_{b_{2}, 1}} \geqslant s_{g, B_{b_{1}, h\left(b_{1}\right)}}+p_{g, B_{b_{1}, h\left(b_{1}\right)}, k}+u_{b_{2}}\right) \wedge 
\left(x_{g, B_{b_{1}, h\left(b_{1}\right)}}=x_{g, B_{b_{2}, 1}}=k\right); \\
k \in M_{g}, b_{1}, b_{2} \in B, b_{1}<b_{2} 。
\end{array} \tag{4}
$$
5.到达结束时间：炼钢工序的操作需在铁水到达后才能开始。
$$
s_{1,j}\geqslant at_j,j\in J \tag{5}
$$
在确定性环境下，考虑生产过程中的温降成本 损失和生产效率提升，以平均工序等时间成本的最小化作为优化目标：
$$
\begin{array}{c}
\text { (P) } \min f=\left(\sum_{j=1}^{n} \gamma_{1} \times\left(s_{1, j}-a t_{j}\right)+\sum_{i=2}^{g} \sum_{j=1}^{n} \gamma_{i} \times\right. \\
\left.\left(s_{i, j}-s_{i-1, j}-p_{i-1, j, x_{i-1, j}}-\operatorname{tr}_{i, i+1}\right)\right) \times \frac{1}{n}
\end{array} \tag{6}
$$
式中$\gamma_i$为各工序等待时间的成本系数。

本文假设加工时间服从如下正态随机分布：
$$
p_{i, j, k} \sim \mathrm{N}\left(\bar{p}_{i, j, k}, \eta_{i} \times \bar{p}_{i, j, k}\right) \tag{7}
$$
$\eta_{i}$为工序ｉ的噪声水平。

在实际生产环境下，炼 钢—连铸调度解在执行过程中出现的性能恶化和不 可行问题常表现为等待时间延长和浇次断浇现象。



# 10 考虑出钢时间和产能的中厚板炉次计划编制方法

## 10.1 概念

### 10.1.1 [YALMIP工具箱](https://yalmip.github.io/)

### 10.1.2 [整数规划问题](https://blog.csdn.net/qq_29831163/article/details/89575446)

#### 1 特点

（i） 原线性规划有优解，当自变量限制为整数后，其整数规划解出现下述情况：

-  ①原线性规划优解全是整数，则整数规划优解与线性规划优解一致。
-  ②整数规划无可行解。
- ③有可行解（当然就存在优解），但优解值变差。 

（ii） 整数规划优解不能按照实数优解简单取整而获得。 

#### 2 求解方法

（i）分枝定界法—可求纯或混合整数线性规划。

**把全部可行解空间反复地分割为越来越小的子集**，称为**分枝**；并且**对每个子集内的解集计算一个目标下界（对于最小值问题）**，这称为**定界**。在每次分枝后，凡是界限超出已知可行解集目标值的那些子集不再进一步分枝，这样，许多子集可不予考虑，这称**剪枝**。这就是分枝定界法的主要思路。

（ii）割平面法—可求纯或混合整数线性规划。

（iii）隐枚举法—求解“0-1”整数规划：    

①过滤隐枚举法；    ②分枝隐枚举法。
（iv）匈牙利法—解决指派问题（“0-1”规划特殊情形）。

（v）蒙特卡洛法—求解各种类型规划。



中厚板炉次计划编制是指以坯料设计确定的板坯集为输入条件 ，为满足规模化生产的需求 ，考虑炉次容量和设备产能等约 束 ，以最小化钢级替代 、出钢时间偏差 、余材产生和板坯未被选择引起的综合惩罚为目标等对各板坯进行组合优化的过程。编制结果给出了每炉钢水对应的钢级 、计划出钢时间以及各板坯的炉次归属情况。

约束条件：

（ １ ） 每块板坯小于炉次容量且不可分割； 

（ ２ ） 每炉钢水对应的板坯厚度 、宽度必须相同； 

（ ３ ） 每炉钢水仅能生产一种钢级，板坯可通过钢级替代的方式采用副钢级（ “ 以优冲次 ” ）进行生产 ； 

（ ４ ） 每炉钢水仅能对应一个计划出钢时间； 

（ ５ ） 考虑转炉钢水容量限制 ，当组成某炉的板坯量不足一炉时，仍然按一炉的容量组织生产，没有订单对应的部分板坯称为余材；

（ ６ ） 每个生产时间段具有最大和最小生产炉数限制。

## 10.2 建模

利用钢级和出钢时间为坐标轴构建二维离散空间，将具有某一确定的钢级和出钢时间组合看作地址（圆 点），将以该钢级和时间进行生产的一个炉次看作在该地址上建造的工厂，将板坯看作处于某一地址的顾客，则中厚板炉次计划编制问题可看作一种选址问题。

![image-20220914162516765](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209141625978.png)

### 10.2.1 参数定义

i：代表唯一钢级和出钢时间的地址序号，$i\in U \in G\times T,G$为钢级集合，T为出钢时间集合；

j：板坯序号，$j \in V$；

$d_j$：板坯 j 的重量需求；

k：炉次序号，$k \in Q$；

$c_{ij}$：板坯 j 采用 i 钢级和出钢时间进行生产的吨钢惩罚系数，包括钢级替代惩罚$c^g_{ij}$和提前或拖期惩罚$c^t_{ij}$；

$P^{su}$：每吨余材对应的惩罚系数；

$P^{sl}$：每吨板坯未被选中的惩罚系数；

$a_{ij}$：板坯 j 的可选择钢级参数，如果可以选择为1，否则为0

$q$：代表每炉钢代表的最大重量限制；

$t$：出钢时间序号；

$N_t^{max},N_t^{min}$：表示某时间周期 t 内最大和最小的计划炉数

### 10.2.2 决策变量

$x_{ij}$：0-1变量，如果板坯 j 采用 i 代表的钢级和时间进行生产则取1，否则为0；

$y_{ik}$：0-1变量，如果 i 代表的钢级和时间的第 k 炉分配有板坯则取1，否则为0；

$z_{ijk}$：0-1变量，如果板坯 j 采用 i 代表的钢级和时间的第 k 炉进行生产则取1，否则为0；

### 10.2.3 建立模型

$$
\operatorname{Min} \sum_{i \in U} \sum_{j \in V} c_{i j} \cdot d_{j} \cdot x_{i j}+\sum_{i \in U} \sum_{k \in Q} p^{s u} \cdot q \cdot y_{i k}-\sum_{j \in V} p^{s u} \cdot d_{j} \cdot \sum_{i \in U} x_{i j}+\sum_{j \in V} p^{s l} \cdot d_{j} \cdot\left(1-\sum_{i \in U} x_{i j}\right) \tag{1}
$$
$$
s.t.
$$

$$
\sum_{i \in U} \sum_{k \in Q} z_{i j k} \leq 1 \quad(\forall j \in V) \tag{2}
$$

$$
\sum_{j \in V} d_{j} z_{i j k} \leq q_{\max } \cdot y_{i k}(\forall i \in U ; \forall k \in Q) \tag{3}
$$

$$
x_{i j} \leq a_{i j}(\forall i \in U ; \forall j \in V) \tag{4}
$$

$$
x_{i j}=\sum_{k \in Q} z_{i j k} \quad(\forall i \in U ; \forall j \in V) \tag{5}
$$

$$
y_{i k} \geq y_{i k+1}(\forall i \in U ; \forall k \in Q) \tag{6}
$$

$$
\sum_{i \in\{\mathrm{t}, \mathrm{G}+1, \ldots,(t+1): \mathrm{G}\}} y_{i k} \leq N_{t}^{\max } \quad t \in\{0, \ldots,|\mathrm{T}|-1\}\tag{7}
$$

$$
\sum_{i \in\{\mathrm{t}|\mathrm{G}|+1, \ldots,(t+1) \cdot|\mathrm{G}|\}} y_{i k} \geq N_{t}^{\min } \quad t \in\{0, \ldots,|\mathrm{T}|-1\} \tag{8}
$$

$$
x_{ij} \in \{0,1\}(\forall j \in U;\forall j \in V) \tag{9}
$$

$$
y_{ik} \in \{0,1\}(\forall j \in U;\forall k \in Q) \tag{10}
$$

$$
z_{ijk} \in \{0,1\}(\forall i \in U;\forall j \in V;\forall k \in Q) \tag{11}
$$

公式1表示损失函数，第一项表示板坯 j 采用 i 钢级和出钢时间进行生产的损失，第二项表示假设进入第k炉以后可能产生的最大因余料而产生的损失值，显然这个值很大需要减掉大部分，第三项就是减去的部分，表示实际生产产出的钢材量，这里模拟由于转炉钢水容量限制而产生的余料。当组成某炉的板坯量不足一炉时，仍然按一炉的容量组织生产。第四部分表示板坯没有进入 k 炉生产产生的损失。

约束2说明每块板坯最多仅能被分配一次，选择唯一的钢级、时间和炉次进行生产

约束3说明每炉分配的板坯总量不能超过炉次的最大容量限制

约束4说明钢级替代约束，只能选择符合替代关系要求的副钢级

约束5说明变量间的关系约束

约束6说明炉次分配需依次进行，减少冗余解的产生

约束7，8说明每个时间段内所有计划生产炉次数满足最大、最小炉次数限制

约束9,10,11为决策变量的取值约束



# 11 考虑铸轧协调的炼钢－连铸－热轧一体化生产计划

## 11.1 概念

从有利于多工序生产组织与及时调整的角度，提出一种分工序编制计划再进行铸轧关系协调的一体化计划方法，面向生产订单，以铸坯为炼钢、连铸、热轧生产的统一对象，建立炉次计划、浇次计划和热轧单元计划编制的逻辑关系类似的组合优化模型，以连铸与热轧的衔接关系构建铸轧协调优化模型，实现促进热送热装的一体化生产计划的整体优化。

![image-20220914193552593](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209141935412.png)



连铸与热轧工序的衔接模式包括冷装、温装、直接热装和直接热轧（直接热轧一般需要专门化的设备及工艺，不在本文考虑范围）

![image-20220914194106613](https://picgo-1259245122.cos.ap-shanghai.myqcloud.com/img/postgraduate/major/note/202209141941370.png)

热轧单元计划包括烫辊材和==主体材部分==，因烫辊材量小，不涉及热送热装的衔接问题，故可不在主计划编制时考虑，仅针对主体材部分进行铸坯的组合优化。

==炼钢－连铸阶段==的主要约束是冶炼钢种、钢级和铸坯规格，涉及铸坯的规格断面组合；

==热轧阶段==主要约束在于宽度和厚度等的组合，同宽有要求且宽度由宽向窄变化，厚度、硬 度等必须平滑变化

## 11.2 各工序的组合优化模型

### 1 铸坯

i：铸坯编号 $i=\{1,2,\dots,I\}$

$w_i$：铸坯 i 的质量

$G^b_i$ ：铸坯 i 的钢级

$W_i^b$：铸坯 i 的宽度

$H_i^b$：铸坯 i 的厚度

$L_i^b$：铸坯 i 的长度

$W_i^{hr}$：铸坯 i 的轧制宽度

$H_i^{hr}$：铸坯 i 的轧制厚度

$L_i^{hr}$：铸坯 i 的轧制长度

根据质量守恒以及考虑到热轧损失：
$$
L_i^b \times W_i^b \times H_i^b \times \rho_i^c \times \eta_i = L_i^{hr} \times W_i^{hr} \times H_i^{hr} \times \rho_i^r
$$
$其中 \eta_i 为铸坯 i 的热轧成材率；\rho_i^c 和\rho_i^r分别为铸坯和热轧板卷的密度$

$T_i^{cc}$：铸坯 i 的出坯时间

$T^{hr}_i$：铸坯 i 的热轧时间

### 2 炉次计划

n：炉次编号，$n=\{1,2,\dots,N\}$

M：炉容量

$G_n^{cc}$：炉次 n 的钢级

$W_n^{cc}$：炉次 n 的 浇铸宽度

$H_n^{cc}$：炉次 n 的 浇铸厚度

### 3 浇次计划

j：浇次编号，$j=\{1,2,\dots,J\}$

$L^{cc}$：中间包寿命，即浇次计划最大可包含的炉次数

### 4 热轧单元计划

k：热轧单元计划编号，$k=\{1,2,\dots,K\}$

$L_k^{max}$：热轧单元计划 k 的最大轧制长度

$L_{SW}^{max}$：热轧板卷同宽最大轧制长度

### 5 决策变量

$u_{i,n}$：0/1变量，当且仅当铸坯被分配到炉次 n 时为1

$\eta_{n,j}$：0/1变量，当且仅当炉次 n 被分配到浇次计划 j 进行浇铸时为1

$x_{i,k}$：0/1变量，当且仅当铸坯 i 被分配到热轧单元计划 k 内轧制时为1

### 6 辅助变量

$u_{i,i',n}$：0/1变量，当且仅当铸坯 i 和 铸坯 i' 同时被分配到炉次 n 时为1

$\eta_{n,n',j}$：0/1变量，当且仅当炉次 n 和 炉次 n' 同时被分配到浇次 j 时为1

$x_{i,i',k}$：0/1变量，当且仅当铸坯 i 和铸坯 i' 同时被分配到热轧单元计划 k 内，且铸坯 i' 被安排到铸坯 i 后轧制时为1

$\xi_{i,i'}$：0/1变量，当且仅当铸坯 i 和铸坯 i' 的热轧宽度相同时为1

### 7 目标函数

$$
f_1=min\sum_{h=1}(U-\sum_{d=1}^DX_{d,h}·Z_d ) \tag{1}
$$

$$
f_2=min\sum_{h=1}\sum_{d=1}^D\sum_{d'=1,d'\ne d}^D Y_{d,d',h}\cdot C_{d,d'} \tag{2}
$$

对于炉次计划，式１为最小化无委材量（即无订单对应的铸坯量)，式２为最小化不满足组炉工艺约束的惩罚，此时
$$
d=i,h=n,U=M,X_{d,h}=u_{i,n},Z_d=w_i,Y_{d,d',h}=u_{i,i',n},C_{d,d'}为不满足组炉约束的惩罚值
$$
对于浇次计划，式1为最小化中间包寿命和浇次内实际炉次数的差值，式2为最小化不满足组浇工艺约束的惩罚，此时
$$
d=n,h=j,U=L^{cc},X_{d,h}=\eta_{n,j},Z_d=1,Y_{d,d',h}=\eta_{n,n',j},C_{d,d'}为不满足组浇约束的惩罚值
$$
对于热轧单元计划，式1为最小化轧辊最大轧制长度与热轧单元计划实际轧制长度的差值，式2为最小化热轧单元计划内相邻铸坯规格跳跃惩罚，此时
$$
d=i,h=k,U=L_{k}^{max},X_{d,h}=x_{i,k},Z_d=L_i^{hr},Y_{d,d',h}=x_{i,i',k},C_{d,d'}为热轧单元计划规格跳跃的惩罚值
$$

### 8 约束条件

不同生产工序计划的设备产能约束可以统一表述：
$$
\sum_{d=1}^DX_{d,h}\cdot Z_d \leq U \tag{3}
$$
对于三种情况的分析同上。

### 9 工序具体的工艺约束条件

#### 1 炉次计划的工艺约束条件

$$
H_i^b\cdot u_{i,n}=H^b_{i'}\cdot u_{i',n} ,u_{i,n} \cdot u_{i',n} = 1 \tag{4}
$$

$$
G_i^b\cdot u_{i,n}=G^b_{i'}\cdot u_{i',n} ,u_{i,n} \cdot u_{i',n} = 1 \tag{5}
$$

式4和式5分别为同一炉次中铸坯厚度、钢级相同。

#### 2 浇次计划的工艺约束条件

$$
H_n^{cc}\cdot \eta_{n,j}=H_{n'}^{cc} \cdot \eta_{n',j},\eta_{n,j} \cdot \eta_{n',j} =1 \tag{6}
$$

$$
\eta _{n,n',j} \cdot |W_n^{cc}-W_{n'}^{cc}| \leq C  \tag{7}
$$

$$
\eta _{n,n',j} \cdot |G_n^{cc}-G_{n'}^{cc}| \leq gC  \tag{8}
$$

式6为浇次内每个炉次浇铸厚度相同；式7为浇次内不同炉次浇铸宽度变化范围，其中Ｃ 为最大调宽范围；式8为浇次内不同炉次钢级连浇约束, ｇＣ为钢级跳跃范围。

#### 3 热轧单元计划的工艺约束条件

$$
\sum_{i=1}^{I} \sum_{i \neq i^{\prime}, i^{\prime}=1}^{I} x_{i, i^{\prime}, k} \cdot \xi_{i, i^{\prime}} \cdot L_{i}^{\mathrm{hr}} \leqslant L_{\mathrm{SW}}^{\max } \tag{9}
$$

$$
\begin{array}{l}
x_{i, i^{\prime}, k} \cdot V W_{i, i^{\prime}} \leqslant W^{\max }(j p) \\
x_{i, i^{\prime}, k} \cdot V H_{i, i^{\prime}} \leqslant H^{\max }(j p) \\
x_{i, i^{\prime}, k} \cdot V S_{i, i^{\prime}} \leqslant S^{\max }(j p) \\
\end{array} \tag{10}
$$

$$
x_{i, i^{\prime}, k} \cdot\left(W_{i^{\prime}}^{\mathrm{hr}}-W_{i}^{\mathrm{hr}}\right) \leqslant 0 \tag{11}
$$

式9为热轧单元计划内同宽最大轧制长度；式 10分别为热轧单元计划内相邻铸坯轧制宽度、厚度和硬度跳跃限制，其中$W^{max}(jp),H^{max}(jp),S^{max}(jp)$分别为热轧单元计划内相邻铸坯的最大轧制宽度、厚度和硬度跳跃值，$VW_{i,i'},VH_{i,i'}，VS_{i,i'}$分别为热轧单元计划内相邻铸坯在轧制宽度、厚度、硬度方面的跳跃值；式11为热轧单 元计划内主体材宽度非增变化。











